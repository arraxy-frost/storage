generator client {
  provider     = "prisma-client"
  output       = "../generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "mysql"
}

model File {
  id           String   @id @default(uuid())
  prefix       String?
  originalName String
  extension    String
  mimeType     String
  size         Int
  url          String
  hash         String   @unique
  uploadedAt   DateTime @default(now())

  // ссылка на директорию
  directoryId String?
  directory   Directory? @relation(fields: [directoryId], references: [id])

  @@map("files")
}

model Directory {
  id   String @id @default(uuid())
  name String

  // self-relation: родительская директория
  parentId String?
  parent   Directory?  @relation("DirectoryToSubdirectories", fields: [parentId], references: [id], onDelete: SetNull)
  children Directory[] @relation("DirectoryToSubdirectories")

  // файлы внутри директории
  files File[]

  @@map("directories")
}
